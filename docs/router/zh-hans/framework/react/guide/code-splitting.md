---
source-updated-at: 2025-02-27T00:19:00.000Z
translation-updated-at: 2025-04-05T03:22:11.000Z
title: ä»£ç åˆ†å‰²
---

ä»£ç åˆ†å‰²ä¸æ‡’åŠ è½½æ˜¯ä¸€ç§å¼ºå¤§çš„æŠ€æœ¯ï¼Œå¯æ˜¾è‘—æ”¹å–„åº”ç”¨çš„åŒ…ä½“ç§¯å’ŒåŠ è½½æ€§èƒ½ã€‚

- å‡å°‘åˆå§‹é¡µé¢åŠ è½½æ—¶éœ€è¦ä¸‹è½½çš„ä»£ç é‡
- æŒ‰éœ€åŠ è½½æ‰€éœ€ä»£ç 
- ç”Ÿæˆä½“ç§¯æ›´å°çš„ä»£ç å—ï¼Œæµè§ˆå™¨å¯æ›´è½»æ¾ç¼“å­˜

## TanStack Router å¦‚ä½•å®ç°ä»£ç åˆ†å‰²ï¼Ÿ

TanStack Router å°†ä»£ç åˆ†ä¸ºä¸¤ç±»ï¼š

- **å…³é”®è·¯ç”±é…ç½®** - æ¸²æŸ“å½“å‰è·¯ç”±å’Œå°½æ—©å¯åŠ¨æ•°æ®åŠ è½½æµç¨‹æ‰€å¿…éœ€çš„ä»£ç ã€‚

  - è·¯å¾„è§£æ/åºåˆ—åŒ–
  - æœç´¢å‚æ•°éªŒè¯
  - åŠ è½½å™¨ã€å‰ç½®åŠ è½½
  - è·¯ç”±ä¸Šä¸‹æ–‡
  - é™æ€æ•°æ®
  - é“¾æ¥
  - è„šæœ¬
  - æ ·å¼
  - å…¶ä»–æœªåˆ—å‡ºçš„è·¯ç”±é…ç½®

- **éå…³é”®/æ‡’åŠ è½½è·¯ç”±é…ç½®** - è·¯ç”±åŒ¹é…éå¿…éœ€ï¼Œå¯æŒ‰éœ€åŠ è½½çš„ä»£ç ã€‚
  - è·¯ç”±ç»„ä»¶
  - é”™è¯¯ç»„ä»¶
  - åŠ è½½ä¸­ç»„ä»¶
  - æœªæ‰¾åˆ°ç»„ä»¶

> ğŸ§  **ä¸ºä½•ä¸åˆ†å‰²åŠ è½½å™¨ï¼Ÿ**
>
> - åŠ è½½å™¨æœ¬èº«å·²æ˜¯å¼‚æ­¥è¾¹ç•Œï¼Œè‹¥åˆ†å‰²åˆ™éœ€é¢å¤–ç­‰å¾…ä»£ç å—åŠ è½½å’ŒåŠ è½½å™¨æ‰§è¡Œ
> - ç›¸æ¯”ç»„ä»¶ï¼ŒåŠ è½½å™¨å¯¼è‡´åŒ…ä½“ç§¯è¿‡å¤§çš„æ¦‚ç‡æ›´ä½
> - åŠ è½½å™¨æ˜¯è·¯ç”±æœ€é‡è¦çš„å¯é¢„åŠ è½½èµ„æºä¹‹ä¸€ï¼ˆç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨é»˜è®¤é¢„åŠ è½½è¡Œä¸ºæ—¶ï¼Œå¦‚æ‚¬åœé“¾æ¥ï¼‰ï¼Œå› æ­¤éœ€è¦ç¡®ä¿å…¶å¯ç”¨æ€§è€Œä¸å¢åŠ å¼‚æ­¥å¼€é”€
>
>   è‹¥äº†è§£åˆ†å‰²åŠ è½½å™¨çš„å¼Šç«¯åä»å¸Œæœ›å®æ–½ï¼Œè¯·å‚é˜…[æ•°æ®åŠ è½½å™¨åˆ†å‰²](#data-loader-splitting)ç« èŠ‚ã€‚

## å°†è·¯ç”±æ–‡ä»¶å°è£…è‡³ç›®å½•

ç”±äº TanStack Router åŸºäºæ–‡ä»¶çš„è·¯ç”±ç³»ç»Ÿæ”¯æŒæ‰å¹³ä¸åµŒå¥—ç»“æ„ï¼Œæ— éœ€é¢å¤–é…ç½®å³å¯å°†è·¯ç”±æ–‡ä»¶å°è£…è‡³ç‹¬ç«‹ç›®å½•ã€‚

æ“ä½œæ­¥éª¤ï¼šå°†è·¯ç”±æ–‡ä»¶ç§»è‡³åŒåç›®å½•å†…ï¼Œå¹¶é‡å‘½åä¸º `route.tsx`ã€‚

**æ”¹é€ å‰**

- `posts.tsx`

**æ”¹é€ å**

- `posts`
  - `route.tsx`

## ä»£ç åˆ†å‰²æ–¹æ¡ˆ

TanStack Router æ”¯æŒå¤šç§ä»£ç åˆ†å‰²æ–¹å¼ã€‚è‹¥ä½¿ç”¨åŸºäºä»£ç çš„è·¯ç”±ï¼Œè¯·è·³è½¬è‡³[åŸºäºä»£ç çš„åˆ†å‰²](#code-based-splitting)ç« èŠ‚ã€‚

ä½¿ç”¨åŸºäºæ–‡ä»¶çš„è·¯ç”±æ—¶ï¼Œå¯é€‰ä»¥ä¸‹æ–¹æ¡ˆï¼š

- [âœ¨ è‡ªåŠ¨ä»£ç åˆ†å‰²](#using-automatic-code-splitting)
- [ä½¿ç”¨ `.lazy.tsx` åç¼€](#using-the-lazytsx-suffix)
- [ä½¿ç”¨è™šæ‹Ÿè·¯ç”±](#using-virtual-routes)

## âœ¨ ä½¿ç”¨è‡ªåŠ¨ä»£ç åˆ†å‰²

è¿™æ˜¯æœ€ä¾¿æ·é«˜æ•ˆçš„ä»£ç åˆ†å‰²æ–¹å¼ã€‚

å¯ç”¨ `autoCodeSplitting` åŠŸèƒ½åï¼ŒTanStack Router ä¼šè‡ªåŠ¨æ ¹æ®å‰è¿°éå…³é”®è·¯ç”±é…ç½®åˆ†å‰²ä»£ç ã€‚

> [!é‡è¦]
> è‡ªåŠ¨ä»£ç åˆ†å‰²**ä»…é™**åŸºäºæ–‡ä»¶çš„è·¯ç”±ï¼Œä¸”éœ€é…åˆ[æ”¯æŒçš„æ‰“åŒ…å™¨](../routing/file-based-routing.md#getting-started-with-file-based-routing)ä½¿ç”¨ã€‚
> **ä¸å…¼å®¹**çº¯ CLI æ¨¡å¼ (`@tanstack/router-cli`)ã€‚

å¯ç”¨æ–¹å¼ï¼ˆåœ¨æ‰“åŒ…å™¨æ’ä»¶é…ç½®ä¸­æ·»åŠ ï¼‰ï¼š

```ts
// vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import { TanStackRouterVite } from '@tanstack/router-plugin/vite'

export default defineConfig({
  plugins: [
    TanStackRouterVite({
      // ...
      autoCodeSplitting: true,
    }),
    react(), // ç¡®ä¿è¯¥æ’ä»¶ä½äºè·¯ç”±æ’ä»¶ä¹‹å
  ],
})
```

å®Œæˆï¼è·¯ç”±æ–‡ä»¶å°†è‡ªåŠ¨æŒ‰å…³é”®/éå…³é”®é…ç½®åˆ†å‰²ã€‚æ›´å¤šæ§åˆ¶é€‰é¡¹è¯¦è§[è‡ªåŠ¨ä»£ç åˆ†å‰²æŒ‡å—](./automatic-code-splitting.md)ã€‚

## ä½¿ç”¨ `.lazy.tsx` åç¼€

è‹¥æ— æ³•ä½¿ç”¨è‡ªåŠ¨åˆ†å‰²ï¼Œå¯é€šè¿‡ `.lazy.tsx` åç¼€æ‰‹åŠ¨åˆ†å‰²ï¼š**å°†ä»£ç ç§»è‡³ `.lazy.tsx` æ–‡ä»¶**ï¼Œå¹¶ä½¿ç”¨ `createLazyFileRoute` æ›¿ä»£ `createFileRoute`ã€‚

> [!é‡è¦] > `__root.tsx` æ ¹è·¯ç”±æ–‡ä»¶ï¼ˆä½¿ç”¨ `createRootRoute` æˆ– `createRootRouteWithContext`ï¼‰**ä¸æ”¯æŒ**ä»£ç åˆ†å‰²ã€‚

`createLazyFileRoute` ä»…æ”¯æŒä»¥ä¸‹é€‰é¡¹ï¼š

| å¯¼å‡ºåç§°            | è¯´æ˜                   |
| ------------------- | ---------------------- |
| `component`         | è·¯ç”±æ¸²æŸ“ç»„ä»¶           |
| `errorComponent`    | åŠ è½½é”™è¯¯æ—¶æ¸²æŸ“çš„ç»„ä»¶   |
| `pendingComponent`  | åŠ è½½è¿‡ç¨‹ä¸­æ¸²æŸ“çš„ç»„ä»¶   |
| `notFoundComponent` | æœªæ‰¾åˆ°è·¯ç”±æ—¶æ¸²æŸ“çš„ç»„ä»¶ |

### `.lazy.tsx` ä»£ç åˆ†å‰²ç¤ºä¾‹

**æ”¹é€ å‰ï¼ˆå•æ–‡ä»¶ï¼‰**

```tsx
// src/routes/posts.tsx
import { createFileRoute } from '@tanstack/react-router'
import { fetchPosts } from './api'

export const Route = createFileRoute('/posts')({
  loader: fetchPosts,
  component: Posts,
})

function Posts() {
  // ...
}
```

**æ”¹é€ åï¼ˆæ‹†åˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼‰**

å…³é”®è·¯ç”±é…ç½®ä¿ç•™åœ¨åŸæ–‡ä»¶ï¼š

```tsx
// src/routes/posts.tsx
import { createFileRoute } from '@tanstack/react-router'
import { fetchPosts } from './api'

export const Route = createFileRoute('/posts')({
  loader: fetchPosts,
})
```

éå…³é”®é…ç½®ç§»è‡³ `.lazy.tsx` æ–‡ä»¶ï¼š

```tsx
// src/routes/posts.lazy.tsx
import { createLazyFileRoute } from '@tanstack/react-router'

export const Route = createLazyFileRoute('/posts')({
  component: Posts,
})

function Posts() {
  // ...
}
```

## ä½¿ç”¨è™šæ‹Ÿè·¯ç”±

è‹¥åˆ†å‰²ååŸè·¯ç”±æ–‡ä»¶ä¸ºç©ºï¼Œå¯ç›´æ¥**åˆ é™¤è¯¥æ–‡ä»¶**ï¼ç³»ç»Ÿå°†è‡ªåŠ¨ç”Ÿæˆè™šæ‹Ÿè·¯ç”±ä½œä¸ºä»£ç åˆ†å‰²æ–‡ä»¶çš„é”šç‚¹ï¼Œè¯¥è™šæ‹Ÿè·¯ç”±ä¼šç›´æ¥å­˜åœ¨äºç”Ÿæˆçš„è·¯ç”±æ ‘æ–‡ä»¶ä¸­ã€‚

**æ”¹é€ å‰ï¼ˆè™šæ‹Ÿè·¯ç”±ï¼‰**

```tsx
// src/routes/posts.tsx
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/posts')({
  // ç©ºæ–‡ä»¶
})
```

**æ”¹é€ åï¼ˆè™šæ‹Ÿè·¯ç”±ï¼‰**

```tsx
// src/routes/posts.lazy.tsx
import { createLazyFileRoute } from '@tanstack/react-router'

export const Route = createLazyFileRoute('/posts')({
  component: Posts,
})

function Posts() {
  // ...
}
```

å®Œæˆï¼ğŸ‰

## åŸºäºä»£ç çš„åˆ†å‰²

ä½¿ç”¨ä»£ç è·¯ç”±æ—¶ï¼Œå¯é€šè¿‡ `Route.lazy()` æ–¹æ³•å’Œ `createLazyRoute` å‡½æ•°å®ç°åˆ†å‰²ï¼š

åˆ›å»ºæ‡’åŠ è½½è·¯ç”±ï¼š

```tsx
// src/posts.tsx
export const Route = createLazyRoute('/posts')({
  component: MyComponent,
})

function MyComponent() {
  return <div>My Component</div>
}
```

åœ¨ `app.tsx` ä¸­é€šè¿‡ `.lazy` æ–¹æ³•å¯¼å…¥ï¼š

```tsx
// src/app.tsx
const postsRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/posts',
}).lazy(() => import('./posts.lazy').then((d) => d.Route))
```

## æ•°æ®åŠ è½½å™¨åˆ†å‰²

**è­¦å‘Šï¼** åˆ†å‰²åŠ è½½å™¨å­˜åœ¨é£é™©ã€‚

è™½èƒ½å‡å°åŒ…ä½“ç§¯ï¼Œä½†ä»£ä»·å¦‚[ä»£ç åˆ†å‰²åŸç†](#how-does-tanstack-router-split-code)ç« èŠ‚æ‰€è¿°ã€‚å¯é€šè¿‡ `lazyFn` å®ç°åˆ†å‰²ï¼Œä½†ä¼šå¼±åŒ–ç±»å‹å®‰å…¨ï¼š

```tsx
import { lazyFn } from '@tanstack/react-router'

const route = createRoute({
  path: '/my-route',
  component: MyComponent,
  loader: lazyFn(() => import('./loader'), 'loader'),
})

// å¦ä¸€æ–‡ä»¶ä¸­
export const loader = async (context: LoaderContext) => {
  // ...
}
```

åŸºäºæ–‡ä»¶çš„è·¯ç”±éœ€é…åˆ[è‡ªåŠ¨ä»£ç åˆ†å‰²](#using-automatic-code-splitting)çš„å®šåˆ¶æ‰“åŒ…é€‰é¡¹æ‰èƒ½åˆ†å‰²åŠ è½½å™¨ã€‚

## é€šè¿‡ `getRouteApi` è·¨æ–‡ä»¶è®¿é—®è·¯ç”± API

ç»„ä»¶ä¸è·¯ç”±åˆ†ç¦»æ—¶ï¼Œå¯ä½¿ç”¨ `getRouteApi` å®‰å…¨è®¿é—®è·¯ç”± APIï¼š

- `my-route.tsx`

```tsx
import { createRoute } from '@tanstack/react-router'
import { MyComponent } from './MyComponent'

const route = createRoute({
  path: '/my-route',
  loader: () => ({
    foo: 'bar',
  }),
  component: MyComponent,
})
```

- `MyComponent.tsx`

```tsx
import { getRouteApi } from '@tanstack/react-router'

const route = getRouteApi('/my-route')

export function MyComponent() {
  const loaderData = route.useLoaderData()
  //    ^? { foo: string }

  return <div>...</div>
}
```

`getRouteApi` æ”¯æŒçš„ç±»å‹å®‰å…¨ APIï¼š

- `useLoaderData`
- `useLoaderDeps`
- `useMatch`
- `useParams`
- `useRouteContext`
- `useSearch`
